module.exports = {
  getRecords: function(req, res) {    
        var pg = require('pg');        
        //You can run command "heroku config" to see what is Database URL from Heroku belt
        var conString = process.env.DATABASE_URL || "postgres://dvnjhlidhvdnwk:qg1zDyEWvMLjUgbESguHMVbqXI@ec2-54-163-238-222.compute-1.amazonaws.com:5432/d6e2f7mm8kvvn0";
        var client = new pg.Client(conString);
        client.connect();
        var query = client.query("select * from employee");
        query.on("row", function (row, result) { 
            result.addRow(row); 
        });
        query.on("end", function (result) {          
            client.end();
            res.writeHead(200, {'Content-Type': 'text/plain'});
            res.write(JSON.stringify(result.rows, null, "    ") + "\n");
            res.end();  
        });
  },
    addRecord : function(req, res){
        var pg = require('pg');          
        var conString = process.env.DATABASE_URL ||  "postgres://dvnjhlidhvdnwk:qg1zDyEWvMLjUgbESguHMVbqXI@ec2-54-163-238-222.compute-1.amazonaws.com:5432/d6e2f7mm8kvvn0";
        var client = new pg.Client(conString);
        client.connect();
        		
		var query1 = client.query("CREATE TABLE timestamp"+
									"("+
									"rec_type varchar(20),"+
									"timestamp varchar(20),"+
									"local_time varchar(20)"+
									")");
									
		query1.on("end", function (result) {          
				//client.end(); 
				res.write('Table timestamp Created');
				res.end();  
			});							
									
		var query2 = client.query("CREATE TABLE purchase_order"+
									"("+
									"PO_NS_ID INTEGER,"+
									"TRAN_DATE DATE,"+
									"PO_NUMBER VARCHAR(20),"+
									"CURRENCY VARCHAR(20),"+
									"MEMO VARCHAR(255),"+
									"ACK_DATE DATE,"+
									"EX_FACTORY_DATE DATE,"+
									"WH_ARRIVAL_DATE DATE,"+
									"DATE_CREATED DATE,"+
									"DELIVERY_METHOD VARCHAR(20),"+
									"SHIPPING_POINT VARCHAR(20),"+
									"SHIPPING_TERMS VARCHAR(20),"+
									"SHIP_TO VARCHAR(20),"+
									"ORDER_STATUS VARCHAR(20),"+
									"RESPONSE_STATUS VARCHAR(20),"+
									"TIMESTAMP INTEGER,"+
									"total varchar,"+
									"tax_total integer"+
									")");
									
		query2.on("end", function (result) {          
				//client.end(); 
				res.write('Table purchase order Created');
				res.end();  
			});
		
		var query3 = client.query("CREATE TABLE packing_list_lines"+
									"("+
									"PACKING_LIST_NS_ID INTEGER,"+
									"ITEM_ID VARCHAR(20),"+
									"ITEM_NAME VARCHAR(20),"+
									"DESCRIPTION VARCHAR(20),"+
									"QTY_ORDERED INTEGER,"+
									"QTY_DISPATCHED INTEGER,"+
									"PO_NS_ID INTEGER,"+
									"NET_WT DECIMAL,"+
									"GROSS_WT DECIMAL,"+
									" packinglist_ref varchar(20),"+
									" REF_PO_NUM varchar(20)"
									")");
									
		query3.on("end", function (result) {          
				//client.end(); 
				res.write('Table packing list Created');
				res.end();  
			});							
									
		var query4 = client.query("CREATE TABLE bill_list"+
									"("+
									"BILL_LIST_NS_ID INTEGER,"+
									"AMOUNT DECIMAL,"+
									"BILL_DATE DATE,"+
									"MEMO VARCHAR(20),"+
									" Status VARCHAR(25),"+
									" po_id varchar(20)"+
									")");
									
		query4.on("end", function (result) {          
				//client.end(); 
				res.write('Table bill list Created');
				res.end();  
			});							
									
		var query5 = client.query("CREATE TABLE bill_list_lines"+
									"("+
									"BILL_LIST_NS_ID INTEGER,"+
									"ITEM_ID VARCHAR(20),"+
									"ITEM_NAME VARCHAR(255),"+
									"DESCRIPTION VARCHAR(255),"+
									"QUANTITY INTEGER,"+
									"AMOUNT DECIMAL,"+
									"TAX_AMOUNT DECIMAL,"+
									"TOTAL_AMOUNT DECIMAL,"+
									"GROSS_WT DECIMAL,"+
									"PO_NS_ID INTEGER"+
									")");
		
		query5.on("end", function (result) {          
				//client.end(); 
				res.write('Table bill list Created');
				res.end();  
			});
		
		var query6 = client.query("CREATE TABLE po_lines"+
									"("+
									"ITEM_ID VARCHAR(20),"+
									"ITEM_NAME VARCHAR(255),"+
									"PO_NS_ID INTEGER,DESCRIPTION VARCHAR(255),"+
									"QTY INTEGER,RATE DECIMAL,"+
									"AMOUNT DECIMAL,"+
									"ITEM_STATUS VARCHAR(255),"+
									" TAX_CODE VARCHAR(255),"+
									"TAX_AMOUNT INTEGER"+
									")");
		
		query6.on("end", function (result) {          
				//client.end(); 
				res.write('Table po lines Created');
				res.end();  
			});
		
		var query7 = client.query("CREATE TABLE packing_list"+
									"("+
									"PACKING_LIST_NS_ID INTEGER,"+
									"SHIP_TO VARCHAR(20),"+
									"SHIP_DATE DATE,"+
									"DELIVERY_METHOD VARCHAR(20),"+
									"SHIPMENT_ORIGIN VARCHAR(20),"+
									"SHIPMENT_POINT VARCHAR(20),"+
									"STATUS VARCHAR(20),"+
									"TIMESTAMP varchar(20),"+
									" packing_list_num varchar(20),"+
									" po_num varchar(20),"+
									" DATE_CREATED date,"+
									" MEMO varchar(20),"+
									" po_ns_id integer,"+
									" id SERIAL PRIMARY KEY"+
									")");
		
		query7.on("end", function (result) {          
				//client.end(); 
				res.write('Table packing list Created');
				res.end();  
			});
		
		var query8 = client.query("CREATE TABLE vendor_master"+
									"("+
									"vendor_ns_id varchar(20),"+
									"first_name varchar(20),"+
									"last_name varchar(20),"+
									"email_id varchar(255),"+
									"phone varchar(20),"+
									"address varchar(255),"+
									"password varchar(20),"+
									"alt_phone varchar(20),"+
									"fax varchar(20)"+
									")");
		
		query8.on("end", function (result) {          
				client.end(); 
				res.write('Table vendor master Created');
				res.end();  
			});
		
		/*
		var query = client.query("insert into employee (firstName,lastName,email,mobile) "+ 
                                "values ('"+req.query.fName+"','"+req.query.lName+"','"+
                                    req.query.email+"','"+req.query.mbl+"')");    
        query.on("end", function (result) {          
            client.end(); 
            res.write('Success');
            res.end();  
        });
		*/
    },    
     delRecord : function(req, res){
        var pg = require('pg');           
        var conString = process.env.DATABASE_URL ||  "postgres://dvnjhlidhvdnwk:qg1zDyEWvMLjUgbESguHMVbqXI@ec2-54-163-238-222.compute-1.amazonaws.com:5432/d6e2f7mm8kvvn0";
        var client = new pg.Client(conString);
        client.connect();         
        var query = client.query( "Delete from employee Where id ="+req.query.id);    
        query.on("end", function (result) {          
            client.end(); 
            res.write('Success');
            res.end();  
        });
    },    
    createTable : function(req, res){
        var pg = require('pg');
        var conString = process.env.DATABASE_URL ||  "postgres://dvnjhlidhvdnwk:qg1zDyEWvMLjUgbESguHMVbqXI@ec2-54-163-238-222.compute-1.amazonaws.com:5432/d6e2f7mm8kvvn0";
        var client = new pg.Client(conString);
        client.connect();         
        
		var query1 = client.query("CREATE TABLE timestamp"+
									"("+
									"rec_type varchar(20),"+
									"timestamp varchar(20),"+
									"local_time varchar(20)"+
									")");
									
		query1.on("end", function (result) {          
				//client.end(); 
				res.write('Table timestamp Created');
				res.end();  
			});							
									
		var query2 = client.query("CREATE TABLE purchase_order"+
									"("+
									"PO_NS_ID INTEGER,"+
									"TRAN_DATE DATE,"+
									"PO_NUMBER VARCHAR(20),"+
									"CURRENCY VARCHAR(20),"+
									"MEMO VARCHAR(255),"+
									"ACK_DATE DATE,"+
									"EX_FACTORY_DATE DATE,"+
									"WH_ARRIVAL_DATE DATE,"+
									"DATE_CREATED DATE,"+
									"DELIVERY_METHOD VARCHAR(20),"+
									"SHIPPING_POINT VARCHAR(20),"+
									"SHIPPING_TERMS VARCHAR(20),"+
									"SHIP_TO VARCHAR(20),"+
									"ORDER_STATUS VARCHAR(20),"+
									"RESPONSE_STATUS VARCHAR(20),"+
									"TIMESTAMP INTEGER,"+
									"total varchar,"+
									"tax_total integer"+
									")");
									
		query2.on("end", function (result) {          
				//client.end(); 
				res.write('Table purchase order Created');
				res.end();  
			});
		
		var query3 = client.query("CREATE TABLE packing_list_lines"+
									"("+
									"PACKING_LIST_NS_ID INTEGER,"+
									"ITEM_ID VARCHAR(20),"+
									"ITEM_NAME VARCHAR(20),"+
									"DESCRIPTION VARCHAR(20),"+
									"QTY_ORDERED INTEGER,"+
									"QTY_DISPATCHED INTEGER,"+
									"PO_NS_ID INTEGER,"+
									"NET_WT DECIMAL,"+
									"GROSS_WT DECIMAL,"+
									" packinglist_ref varchar(20),"+
									" REF_PO_NUM varchar(20)"
									")");
									
		query3.on("end", function (result) {          
				//client.end(); 
				res.write('Table packing list Created');
				res.end();  
			});							
									
		var query4 = client.query("CREATE TABLE bill_list"+
									"("+
									"BILL_LIST_NS_ID INTEGER,"+
									"AMOUNT DECIMAL,"+
									"BILL_DATE DATE,"+
									"MEMO VARCHAR(20),"+
									" Status VARCHAR(25),"+
									" po_id varchar(20)"+
									")");
									
		query4.on("end", function (result) {          
				//client.end(); 
				res.write('Table bill list Created');
				res.end();  
			});							
									
		var query5 = client.query("CREATE TABLE bill_list_lines"+
									"("+
									"BILL_LIST_NS_ID INTEGER,"+
									"ITEM_ID VARCHAR(20),"+
									"ITEM_NAME VARCHAR(255),"+
									"DESCRIPTION VARCHAR(255),"+
									"QUANTITY INTEGER,"+
									"AMOUNT DECIMAL,"+
									"TAX_AMOUNT DECIMAL,"+
									"TOTAL_AMOUNT DECIMAL,"+
									"GROSS_WT DECIMAL,"+
									"PO_NS_ID INTEGER"+
									")");
		
		query5.on("end", function (result) {          
				//client.end(); 
				res.write('Table bill list Created');
				res.end();  
			});
		
		var query6 = client.query("CREATE TABLE po_lines"+
									"("+
									"ITEM_ID VARCHAR(20),"+
									"ITEM_NAME VARCHAR(255),"+
									"PO_NS_ID INTEGER,DESCRIPTION VARCHAR(255),"+
									"QTY INTEGER,RATE DECIMAL,"+
									"AMOUNT DECIMAL,"+
									"ITEM_STATUS VARCHAR(255),"+
									" TAX_CODE VARCHAR(255),"+
									"TAX_AMOUNT INTEGER"+
									")");
		
		query6.on("end", function (result) {          
				//client.end(); 
				res.write('Table po lines Created');
				res.end();  
			});
		
		var query7 = client.query("CREATE TABLE packing_list"+
									"("+
									"PACKING_LIST_NS_ID INTEGER,"+
									"SHIP_TO VARCHAR(20),"+
									"SHIP_DATE DATE,"+
									"DELIVERY_METHOD VARCHAR(20),"+
									"SHIPMENT_ORIGIN VARCHAR(20),"+
									"SHIPMENT_POINT VARCHAR(20),"+
									"STATUS VARCHAR(20),"+
									"TIMESTAMP varchar(20),"+
									" packing_list_num varchar(20),"+
									" po_num varchar(20),"+
									" DATE_CREATED date,"+
									" MEMO varchar(20),"+
									" po_ns_id integer,"+
									" id SERIAL PRIMARY KEY"+
									")");
		
		query7.on("end", function (result) {          
				//client.end(); 
				res.write('Table packing list Created');
				res.end();  
			});
		
		var query8 = client.query("CREATE TABLE vendor_master"+
									"("+
									"vendor_ns_id varchar(20),"+
									"first_name varchar(20),"+
									"last_name varchar(20),"+
									"email_id varchar(255),"+
									"phone varchar(20),"+
									"address varchar(255),"+
									"password varchar(20),"+
									"alt_phone varchar(20),"+
									"fax varchar(20)"+
									")");
		
		query8.on("end", function (result) {          
				client.end(); 
				res.write('Table vendor master Created');
				res.end();  
			});
		
		/*var query = client.query( "CREATE TABLE employee"+
                                    "("+
                                      "firstname character varying(50),"+
                                      "lastname character varying(20),"+
                                      "email character varying(30),"+
                                      "mobile character varying(12),"+
                                      "id serial NOT NULL"+
                                    ")");    
        query.on("end", function (result) {          
            client.end(); 
            res.write('Table Schema Created');
            res.end();  
        });*/
    },    
    dropTable : function(req, res){
        var pg = require('pg');           
        var conString = process.env.DATABASE_URL || "postgres://dvnjhlidhvdnwk:qg1zDyEWvMLjUgbESguHMVbqXI@ec2-54-163-238-222.compute-1.amazonaws.com:5432/d6e2f7mm8kvvn0";
        var client = new pg.Client(conString);
        client.connect();         
        var query = client.query( "Drop TABLE employee");    
        query.on("end", function (result) {          
            client.end(); 
            res.write('Table Schema Deleted');
            res.end();  
        });
    }    
};